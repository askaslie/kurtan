<!DOCTYPE html>
<html>
<head>
</head>
<body style="height: 100%; margin: 0; overflow: hidden;">
<!--[if IE]><script src="js/soup/js/explorercanvas/excanvas.js"></script><![endif]-->
<script src="../kurtan/js/soup/js/jsgamesoup.js"></script>
<script>
    /*0 - wall
    * 1 - floor
    * 2 - mark
    * 3 - mark with chest
    * 4 - floor with chest
    * 5 - floor with gamer
    * 5 - mark with gamer
    * 6 - exit
    */

     var levelArray = [ [0,0,0,0,0,0,0,0],
                        [0,5,1,1,1,1,1,0],
                        [0,1,1,1,1,1,1,0],
                        [0,1,1,1,1,1,1,0],
                        [0,1,1,1,1,1,1,0],
                        [0,1,1,1,1,1,1,0],
                        [0,1,1,1,1,1,1,0],
                        [0,0,0,0,0,0,0,0]
                        ];

//     var backgroundColorsArray = { '0': }


    function startGame(gs) {

        function A() {

            this.keyDown = function(k) {
                console.log(k);

                switch(k) {
                    case 39: {
                        for (var rowNumber = 0; rowNumber < levelArray.length; rowNumber++) {
                            for(var columnNumber = 0; columnNumber < levelArray[rowNumber].length; columnNumber++) {
                                if( levelArray[rowNumber][columnNumber] == 5){
                                    if (columnNumber < (levelArray[0].length - 1)) {
                                        levelArray[rowNumber][columnNumber] = 1;
                                        levelArray[rowNumber][columnNumber + 1] = 5;
                                    }
                                    break;
                                }
                            }
                        }
                    }

                }
            };
        }

        function Cell(row, col) {
            this.type;

            this.update = function() {
                this.type = levelArray[row][col];
            }

            this.draw = function(canvas,gs) {
                canvas.beginPath();
                canvas.rect(col * 60, row * 60, 60, 60);

                canvas.closePath();
                canvas.stroke();
                if ( this.type == 5) {
                    canvas.fill();
                } else if ( this.type == 0) {
                    canvas.fillStyle = "#FF0000";
                    canvas.fill();
                }
            }

        }

        for (var rowNumber = 0; rowNumber < levelArray.length; rowNumber++) {
            for(var columnNumber = 0; columnNumber < levelArray[rowNumber].length; columnNumber++) {
                gs.addEntity( new Cell(rowNumber, columnNumber));
            }
        }
        gs.addEntity(new A());
//        gs.addEntity(new GameBoard());
//        for (i=0; i<20; i++)
//            gs.(new C());
    }
</script>
<canvas id='surface' jsgs='startGame' width="480" height="480"  ></canvas>
</body>
</html>

